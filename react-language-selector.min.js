React.LS=function(){var e=function(e,t){var n=this;n.dLang=t,n.dLangFile=e,"undefined"!=typeof Storage?n.set_load_lang(n.getsetting("lang",t),n.getsetting("langfile",e),!0):n.set_load_lang(t,e,!0)};return Array.prototype.contains=function(e){for(var t=this.length;t--;)if(this[t]===e)return!0;return!1},e.prototype.dLangFile="",e.prototype.dLang="",e.prototype.pack={},e.prototype.loadedfiles=[],e.prototype.ready=function(e){"loading"!=document.readyState?e():document.addEventListener("DOMContentLoaded",e)},e.prototype.loadLangPack=function(e,t,n){var o=this;o.loadedfiles.contains(t)?(localStorage.setItem("langfile",t),e()):o.loadJSON(function(a){var s=JSON.parse(a);if(1==n)o.pack=s;else for(var p=0;p<s.length;p++)o.pack.push(s[p]);localStorage.setItem("langfile",t),e()},t)},e.prototype.set_lang=function(e){for(var t,n=this,o=0,a=0;a<n.pack.length;a++)if(n.pack[a].lang==e){var s=document.evaluate(n.pack[a].elem,document,null,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null),p=s.iterateNext();if(0!=a){if(n.pack[a].elem==t&&o++,0!=o)for(var l=0;o>l;l++)p=s.iterateNext();React.SHP.render(p.outerHTML,n.pack[a].text,n.pack[a].attr,!0,p.parentNode)}else React.SHP.render(p.outerHTML,n.pack[a].text,n.pack[a].attr,!0,p.parentNode);t=n.pack[a].elem}localStorage.setItem("lang",e)},e.prototype.set_load_lang=function(e,t,n){var o=this;o.loadLangPack(function(){1==n?o.ready(function(){o.set_lang(e)}):o.set_lang(e)},t,n)},e.prototype.getsetting=function(e,t){return localStorage[e]||t},e.prototype.loadJSON=function(e,t){var n=this,o=new XMLHttpRequest;try{o.open("GET",t,!0),o.overrideMimeType("application/json"),o.setRequestHeader("Content-Type","application/json"),o.setRequestHeader("Accept-Encoding","gzip"),o.send(null),o.onreadystatechange=function(){301==o.status||302==o.status||303==o.status||307==o.status||308==o.status?alert("Redirected"):4==o.readyState&&200==o.status&&(n.loadedfiles.push(t),e(o.responseText))}}catch(a){alert(a),n.set_load_lang(n.dLang,n.dLangFile,!1)}},e.prototype.UI=React.createClass({displayName:"ReactLanguageSelectorUI",propTypes:{items:React.PropTypes.array.isRequired,openMode:React.PropTypes.string,hoverTimeout:React.PropTypes.number,gridColumns:React.PropTypes.oneOfType([React.PropTypes.number,React.PropTypes.func]),showFlag:React.PropTypes.bool,selectedLang:React.PropTypes.oneOfType([React.PropTypes.string,React.PropTypes.func]),onPopupOpening:React.PropTypes.func,onPopupOpened:React.PropTypes.func,onPopupClosing:React.PropTypes.func,onPopupClosed:React.PropTypes.func,onLanguageChanged:React.PropTypes.func},getDefaultProps:function(){return{gridColumns:1,showFlag:!0,openMode:"hover",hoverTimeout:200,selectedLang:null,onPopupOpening:null,onPopupOpened:null,onPopupClosing:null,onPopupClosed:null,onLanguageChanged:null}},getInitialState:function(){for(var e=this.props.items,t=this.props.selectedLang,n=null,o=0;o<e.length;o++){var a=e[o];t===a.id&&(n=a)}return{popupOpened:!1,selectedLang:n?n:e[0],closePopupTimeout:-1}},_documentClickHandler:function(){this._processEvent({id:"onPopupClosing"}),this.setState({popupOpened:!1}),this._processEvent({id:"onPopupClosed"})},_documentKeyHandler:function(e){27===e.keyCode&&(this._processEvent({id:"onPopupClosing"}),this.setState({popupOpened:!1}),this._processEvent({id:"onPopupClosed"}))},_processEvent:function(e){var t=this.props.onPopupOpening,n=this.props.onPopupOpened,o=this.props.onPopupClosing,a=this.props.onPopupClosed,s=this.props.onLanguageChanged;"onPopupOpening"===e.id?t&&t(this):"onPopupOpened"===e.id?(document.addEventListener("click",this._documentClickHandler),document.addEventListener("keydown",this._documentKeyHandler),n&&n(this)):"onPopupClosing"===e.id?(document.removeEventListener("click",this._documentClickHandler),document.removeEventListener("keydown",this._documentKeyHandler),o&&o(this)):"onPopupClosed"===e.id?a&&a(this):"onLanguageChanged"===e.id?s&&s(e.selectedLang):"clearClosePopupTimeout"===e.id&&this.state.closePopupTimeout>-1&&(clearTimeout(this.state.closePopupTimeout),this.state.closePopupTimeout=-1)},_onLanguageSelected:function(e,t){return t.stopPropagation(),this._processEvent({id:"clearClosePopupTimeout"}),this._processEvent({id:"onPopupClosing"}),this.setState({selectedLang:e,popupOpened:!1}),this._processEvent({id:"onPopupClosed"}),this._processEvent({id:"onLanguageChanged",selectedLang:e}),!1},_onClick:function(e){return e.stopPropagation(),this.state.popupOpened?(this._processEvent({id:"onPopupClosing"}),this.setState({popupOpened:!1}),this._processEvent({id:"onPopupClosed"})):(this._processEvent({id:"onPopupOpening"}),this.setState({popupOpened:!0}),this._processEvent({id:"onPopupOpened"})),!1},_onHover:function(e,t){var n=this,o=this.props.hoverTimeout;return t.stopPropagation(),e?(this._processEvent({id:"clearClosePopupTimeout"}),this.state.popupOpened||(this._processEvent({id:"onPopupOpening"}),this.setState({popupOpened:!0}),this._processEvent({id:"onPopupOpened"}))):this.state.closePopupTimeout<0&&(this.state.closePopupTimeout=setTimeout(function(){n._processEvent({id:"onPopupClosing"}),n.setState({popupOpened:!1}),n._processEvent({id:"onPopupClosed"})},o)),!1},render:function(){var e=this,t=this.props.items,n=this.props.openMode,o=this.props.gridColumns,a=this.props.showFlag,s=Math.round(t.length/o),p=this.state.selectedLang,l=this.state.popupOpened,r=[],i=function(){for(var n=[],o=0;o<t.length;o++){var l=t[o],i="";l.id===p.id&&(i="rlsui-selected-locale"),r.push(a?React.createElement("li",null,React.createElement("a",{href:"#",className:i,title:l.title,onClick:e._onLanguageSelected.bind(e,l)},React.createElement("img",{src:l.flagImg,alt:l.flagTitle})," ",l.name)):React.createElement("li",null,React.createElement("a",{href:"#",className:i,title:l.title,onClick:e._onLanguageSelected.bind(e,l)}," ",l.name))),(o+1)%s===0&&(n.push(React.createElement("td",null,React.createElement("ul",null,r))),r=[])}return r.length>0&&(n.push(React.createElement("td",null,React.createElement("ul",null,r))),r=[]),n},c=function(){var t="";return a&&(t=React.createElement("img",{src:p.flagImg,alt:p.flagTitle})),"hover"===n?React.createElement("a",{className:"rlsui-selected-locale",href:"#",onMouseEnter:e._onHover.bind(e,!0),onMouseLeave:e._onHover.bind(e,!1)},t," ",p.name):React.createElement("a",{className:"rlsui-selected-locale",href:"#",onClick:e._onClick},t," ",p.name)},u=function(){var t={};return l||(t.display="none"),"hover"===n?React.createElement("div",{className:"rlsui-language-container-scrollable",style:t,onMouseEnter:e._onHover.bind(e,!0),onMouseLeave:e._onHover.bind(e,!1)},React.createElement("table",{className:"rlsui-language-container"},React.createElement("tbody",null,React.createElement("tr",null,i())))):React.createElement("div",{className:"rlsui-language-container-scrollable",style:t},React.createElement("table",{className:"rlsui-language-container"},React.createElement("tbody",null,React.createElement("tr",null,i()))))};return React.createElement("div",{className:"react-language-selector-ui"},c()," ",u())}}),e}();